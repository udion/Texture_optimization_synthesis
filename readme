An attempt to implement kwatra's paper